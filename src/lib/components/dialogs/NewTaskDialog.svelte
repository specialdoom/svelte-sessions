<script lang="ts">
  import {
    Dialog,
    FormItem,
    Radio,
    Textarea,
    TextInput,
  } from "@specialdoom/proi-ui";
  import dayjs from "dayjs";
  import { createEventDispatcher } from "svelte";
  import { generateNewTask, TASKS } from "../../utils/task";
  import type { Task } from "../../utils/types";

  export let visible: boolean = true;

  let task: Task = generateNewTask();

  const dispatch = createEventDispatcher();

  function addNewTask() {
    dispatch("add-task", task);
    visible = false;
  }
</script>

<Dialog
  bind:visible
  title="🗒️ Add new task: {dayjs().format('DD/MM/YYYY, HH:mm')}"
  on:ok={addNewTask}
>
  <FormItem label="Title">
    <TextInput placeholder="Task title" bind:value={task.title} />
  </FormItem>
  <FormItem label="Description" description="Optional">
    <Textarea
      placeholder="Task description"
      bind:value={task.description}
      rows={2}
    />
  </FormItem>
  <FormItem label="Task type">
    <div class="radio-group">
      {#each Object.entries(TASKS) as entry}
        <Radio value={entry[0]} bind:group={task.type}>
          {entry[1]}
        </Radio>
      {/each}
    </div>
  </FormItem>
</Dialog>

<style>
  .radio-group {
    display: flex;
    flex-wrap: wrap;
    width: 300px;
    gap: 4px;
  }
</style>
